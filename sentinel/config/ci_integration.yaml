# CI/CD Integration Configuration
# Part of Project SENTINEL - QA Environment Validation Tool
# Version: 1.0.0

# Pre-test validation steps
pre_test_validation:
  system_check:
    enabled: true
    timeout: 300  # seconds
    steps:
      - name: "System Tools"
        validator: "validate_tools"
        critical: true
      - name: "System Resources"
        validator: "validate_resources"
        critical: true
      - name: "Dependencies"
        validator: "validate_dependencies"
        critical: true

  environment_setup:
    enabled: true
    timeout: 600  # seconds
    steps:
      - name: "Directory Structure"
        validator: "validate_directory_structure"
        critical: true
      - name: "Permissions"
        validator: "validate_permissions"
        critical: true
      - name: "Configurations"
        validator: "validate_configurations"
        critical: true
      - name: "Certificates"
        validator: "validate_certificates"
        critical: true

  service_check:
    enabled: true
    timeout: 300  # seconds
    steps:
      - name: "Network Configuration"
        validator: "validate_network"
        critical: true
      - name: "Process State"
        validator: "validate_processes"
        critical: true

# Post-test validation steps
post_test_validation:
  resource_cleanup:
    enabled: true
    timeout: 300  # seconds
    steps:
      - name: "Process Cleanup"
        script: "cleanup_processes.sh"
        critical: true
      - name: "Network Cleanup"
        script: "cleanup_network.sh"
        critical: true
      - name: "File Cleanup"
        script: "cleanup_files.sh"
        critical: false

  state_verification:
    enabled: true
    timeout: 300  # seconds
    steps:
      - name: "System State"
        validator: "validate_system_state"
        critical: true
      - name: "Resource State"
        validator: "validate_resource_state"
        critical: true

# Reporting configuration
reporting:
  formats:
    - type: "junit"
      enabled: true
      output: "test-results/qa-validation.xml"
      
    - type: "json"
      enabled: true
      output: "test-results/qa-validation.json"
      
    - type: "html"
      enabled: true
      output: "test-results/qa-validation.html"
      template: "templates/report.html"

  metrics:
    prometheus:
      enabled: true
      port: 9090
      metrics:
        - name: "qa_validation_duration_seconds"
          help: "Duration of QA validation steps"
          type: "gauge"
        - name: "qa_validation_errors_total"
          help: "Total number of validation errors"
          type: "counter"
        - name: "qa_resource_usage_percent"
          help: "Resource usage percentage"
          type: "gauge"
          labels:
            - "resource_type"
            - "component"

# Notification configuration
notifications:
  slack:
    enabled: false
    webhook_url: "${SLACK_WEBHOOK_URL}"
    channels:
      - "#qa-validation"
      - "#ci-alerts"

  email:
    enabled: false
    smtp_server: "${SMTP_SERVER}"
    from: "qa-validation@example.com"
    to:
      - "qa-team@example.com"
      - "dev-team@example.com"

# Integration points
integration:
  jenkins:
    stage_name: "QA Validation"
    fail_build: true
    artifacts:
      - "test-results/*.xml"
      - "test-results/*.json"
      - "test-results/*.html"
      - "logs/*.log"

  github:
    status_check: true
    required: true
    context: "qa-validation"
    artifacts:
      - path: "test-results"
        name: "QA Validation Results"
        content_type: "text/html"

# Resource thresholds
thresholds:
  cpu_usage: 80  # percentage
  memory_usage: 70  # percentage
  disk_usage: 85  # percentage
  network_usage: 75  # percentage
  process_count: 100
  file_descriptors: 1000

# Validation timeouts
timeouts:
  system_check: 300  # seconds
  resource_validation: 300  # seconds
  dependency_check: 300  # seconds
  network_validation: 300  # seconds
  process_validation: 300  # seconds
  cleanup: 300  # seconds

# Retry configuration
retry:
  max_attempts: 3
  delay: 60  # seconds
  backoff_multiplier: 2
  conditions:
    - "ResourceTemporarilyUnavailable"
    - "NetworkTimeout"
    - "ServiceStarting"
